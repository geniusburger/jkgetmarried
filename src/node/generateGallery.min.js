var path=require("path"),fs=require("fs"),os=require("os"),sizeOf=require("image-size"),args=require("minimist")(process.argv.slice(2),{string:["inDir","outFile"],alias:{inDir:"i",outFile:"o"}}),imageExtensions=["bmp","gif","jpg","png"];function isImage(a){return fs.statSync(path.join(dir,a)).isFile()&&(a=path.extname(a),2<=a.length)?-1<imageExtensions.indexOf(a.toLowerCase().substring(1)):!1}console.dir(args);if(!args.inDir)throw Error("inDir arg is missing");
if(!args.outFile)throw Error("outFile arg is missing");for(var images=0,maxRatio=0,minRatio=10,dir=args.inDir,files=fs.readdirSync(dir),now=new Date,data=["gallery = {","\timages : ["],i=0;i<files.length;i++)if(isImage(files[i])){images++;var dimensions=sizeOf(path.join(dir,files[i])),ratio=dimensions.height/dimensions.width;ratio>maxRatio&&(maxRatio=ratio);ratio<minRatio&&(minRatio=ratio);data.push("\t\t{name: '"+files[i]+"', caption: 'caption"+i+"'},")}data.push("\t],");
data.push("\tmaxRatio: "+maxRatio+",");data.push("\tminRatio: "+minRatio);data.push("};");console.log("Found "+images+" images");fs.writeFileSync(args.outFile,data.join(os.EOL));
