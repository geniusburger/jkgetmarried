jk={};jk.weddingDate=new Date(2015,5,27,16,0,0,0);jk.scrollPixelsPerSecond=2E3;jk.maxScrollTime=2E3;jk.initialGalleryLoadCount=2;jk.icons="flaticon-balloon11 flaticon-bell53 flaticon-bouquet1 flaticon-bow9 flaticon-cake20 flaticon-camera97 flaticon-champagne7 flaticon-chicken18 flaticon-chicken19 flaticon-gift69 flaticon-heart310 flaticon-heart311 flaticon-heart312 flaticon-heart313 flaticon-hearts10 flaticon-jewel2 flaticon-passion flaticon-ring25 flaticon-rings3 flaticon-rose14".split(" ");
jk.setup=function(){jk.$window=$(window);jk.$body=$("body");jk.$bg=$(".bg");jk.$toggle=$("button.navbar-toggle");jk.$gallery=$("#gallery");jk.setupEggs();jk.setupIcons();jk.populateNavs();jk.collapseNavOnClick();jk.affixSideNav();jk.fixSideNavAffixWidth();jk.setupAccordion();jk.startCounter();jk.setupGallery();jk.setupParallax();jk.setupDemo();$(".sidebar a, .navbar a, a.smooth").click(jk.smoothScroll);$(document.forms.rsvp).submit(jk.rsvp);$(document.forms.sign).submit(jk.signGuestBook);$(document.forms._xclick).submit(jk.honeymoon);
$("#askus").click(jk.askus);jk.readGuestBook();jk.resizeHandler()};
jk.setupAccordion=function(){$("#accordion>.panel").each(function(a,c){var b=$(c);b.addClass("panel-jk-secondary");var d=b.children(".panel-title").first().remove(),e=b.children(".panel-body").first().remove();b.append('<div class="panel-heading" role="tab"><a data-toggle="collapse" data-parent="#accordion" href="#collapse'+a+'"'+(0<a?' class="collapsed"':"")+'><h4 class="panel-title">'+d.html()+'<span class="status"></span></h4></a></div>');b.append('<div id="collapse'+a+'" class="panel-collapse collapse'+
(0===a?" in":"")+'" role="tabpanel"><div class="panel-body">'+e.html()+"</div></div>")})};jk.setupIcons=function(){$("h1.page-header [class^=flaticon-]").click(jk.iconClickHandler)};jk.iconClickHandler=function(){var a=jk.icons.indexOf(this.className)+1;a>=jk.icons.length&&(a=0);this.className=jk.icons[a]};jk.setupEggs=function(){document.querySelector(".brand").onclick=function(){game.toggle(jk.$body)}};jk.reverse=function(a){return a.split("").reverse().join("")};
jk.askus=function(){game.gainLife();window.location.href=jk.reverse("noitseuq02%a02%evah02%I=tcejbuS?moc.deirramtegkj@snoitseuq:otliam");return!1};jk.readGuestBook=function(){var a=$.post("submit.php","action=read");a.done(function(a){var b;try{b=JSON.parse(a)}catch(d){b={result:"json error",error:a}}"success"==b.result?jk.populateGuestBook(b.data):console.error("read error",b.error)});a.fail(function(){document.forms.sign.submit.innerHTML="Error"})};
jk.populateGuestBook=function(a){var c=document.getElementById("guestBookMessages");util.removeChildren(c);a.forEach(function(a){var d=document.createElement("div");d.className="panel panel-msg";var e=document.createElement("div");d.appendChild(e);e.className="panel-heading";e.appendChild(jk.buildSpan("message-name",a.name));e.appendChild(jk.buildSpan("badge pull-right",a.date));e=document.createElement("div");d.appendChild(e);e.className="panel-body";e.appendChild(jk.buildSpan("message-body",a.message));
c.appendChild(d)})};jk.buildSpan=function(a,c){var b=document.createElement("span");b.className=a;b.innerHTML=c;return b};jk.honeymoon=function(){game.gainLife();$(this).append('<input type="hidden" name="business" value="'+jk.reverse("moc.deirramtegkj@noomyenoh")+'">');return!0};
jk.signGuestBook=function(a){game.gainLife();a.preventDefault();a=$.post("submit.php",$(this).serialize());util.disableForm(this);this.submit.innerHTML="sending...";a.done(function(a){var b;try{b=JSON.parse(a)}catch(d){b={result:"json error",error:a}}a=document.forms.sign.submit;"success"==b.result?(util.enableForm(document.forms.sign),a.innerHTML="Sign",document.forms.sign.reset(),jk.readGuestBook(),$("#signPanel").find(".panel-heading a").click()):(a.innerHTML="Failure. Try again?",util.setBtnType(a,
"danger"),util.enableForm(document.forms.sign),console.error("sign error",b.error))});a.fail(function(){document.forms.sign.submit.innerHTML="Error"})};
jk.rsvp=function(a){game.gainLife();a.preventDefault();a=$.post("submit.php",$(this).serialize());util.disableForm(this);this.submit.innerHTML="sending...";a.done(function(a){var b;try{b=JSON.parse(a)}catch(d){b={result:"json error",error:a}}a=document.forms.rsvp.submit;"success"==b.result?(a.innerHTML="Thanks for letting us know!",util.setBtnType(a,"success")):(a.innerHTML="Failure. Try again?",util.setBtnType(a,"danger"),util.enableForm(document.forms.rsvp),console.error("rsvp error",b.error))});
a.fail(function(){document.forms.rsvp.submit.innerHTML="Error"})};jk.populateNavs=function(){for(var a=document.getElementById("sideList"),c=document.getElementById("topList"),b=document.querySelectorAll(".section > .page-header"),d=0;d<b.length;d++)a.appendChild(jk.buildNavItem(b[d].id,b[d].textContent)),c.appendChild(jk.buildNavItem(b[d].id,b[d].textContent))};
jk.buildNavItem=function(a,c){var b=document.createElement("li"),d=document.createElement("a");b.appendChild(d);d.href="#"+a;d.innerHTML=c;return b};jk.isTopMenuVisible=function(){return jk.$toggle.is(":visible")};jk.collapseNavOnClick=function(){$("#topList").children("li").children("a").on("click",function(){jk.isTopMenuVisible()&&jk.$toggle.click()})};
jk.affixSideNav=function(){$("#sideNav").affix({offset:{top:function(){return this.top=$("#banner").height()},bottom:function(){return this.bottom=$(".footer").outerHeight(!0)}}})};jk.fixSideNavAffixWidth=function(){$("[data-clampedwidth]").each(function(){var a=$(this),c=a.data("clampedwidth"),b=function(){var b=$(c).width();a.css("width",b)};b();jk.$window.resize(b)})};
jk.startCounter=function(){var a=document.querySelectorAll(".counter-label td"),c=document.querySelectorAll(".counter-data td"),b=document.querySelector(".progress-bar"),d=document.querySelector(".target-date td");countdownTimer.initialize(jk.weddingDate,d,a,c,b,!0)};
jk.setupParallax=function(){if(jk.isTopMenuVisible())jk.$bg.css({position:"absolute",top:"0px"}),jk.speedDivisor=1;else{jk.speedDivisor=jk.$bg.data("speed-divisor");if(!jk.speedDivisor||0>jk.speedDivisor)jk.speedDivisor=1;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame;jk.$window.scroll(function(){window.requestAnimationFrame(jk.scrollHandler)})}jk.$window.resize(jk.resizeHandler);$(".panel a").mouseup(function(){window.setTimeout(jk.resizeHandler,
1E3)});jk.startupResizeCount=0;jk.resizeHandler();for(var a=0;1E4>a;a+=1E3)window.setTimeout(jk.resizeHandler,a)};jk.resizeHandler=function(){var a=jk.$body.height(),c=jk.$window.height(),b=$(".navbar-fixed-top");b.is(":visible")&&(c-=b.height());jk.$bg.height(1+c+(a-c)/jk.speedDivisor);50>jk.startupResizeCount&&(jk.lastHeight===a&&jk.startupResizeCount++,jk.lastHeight=a,window.setTimeout(jk.resizeHandler,50));jk.resizeGallery(c)};
jk.scrollHandler=function(){var a=jk.$window.scrollTop(),a=-Math.round(a/jk.speedDivisor);jk.lastTranslateY!==a&&(jk.lastTranslateY=a,jk.$bg.css("transform","translateY("+a+"px)"))};
jk.setupDemo=function(){if(document.getElementById("demo")){for(var a=document.querySelector("#bgpanel .panel-body"),c=0;c<bg.filenames.length;c++){var b=document.createElement("div");b.className="col-md-2";var d=document.createElement("div");d.className="center-block";var e=document.createElement("img");e.src="images/tiles/"+bg.filenames[c];e.onclick=jk.changeBackgroundImage;e.title=bg.filenames[c];d.appendChild(e);b.appendChild(d);a.appendChild(b)}(a=util.getCookie("bgimg"))?jk.$bg.css("backgroundImage",
"url('"+a+"')"):jk.$bg.css("backgroundImage","url('images/tiles/"+bg.filenames[0]+"')");$("#speedbutton").click(jk.switchSpeed);$("#speedinput").val(jk.speedDivisor)}else jk.$bg.css("backgroundImage","url('images/tiles/dark--floorboard-wood-background-texture-025.jpg')")};jk.switchSpeed=function(){var a=$("#speedinput").val();isNaN(a)||(jk.speedDivisor=a,jk.resizeHandler());return!1};
jk.changeBackgroundImage=function(a){jk.$bg.css("backgroundImage","url('"+a.target.src+"')");util.setCookie("bgimg",a.target.src)};jk.smoothScroll=function(){this.blur();game.loseLife();var a;a=this.href.substring(this.href.indexOf("#"));var c=$("body, html");"#"===a?a=0:(a=$(a),a=a.offset().top);var b=1E3*Math.abs(a-jk.$window.scrollTop())/jk.scrollPixelsPerSecond;b>jk.maxScrollTime&&(b=jk.maxScrollTime);c.stop(!0);c.animate({scrollTop:a},b);return!1};
jk.shuffle=function(a){for(var c=a.length,b,d;0!==c;)d=Math.floor(Math.random()*c),c-=1,b=a[c],a[c]=a[d],a[d]=b;return a};
jk.setupGallery=function(){var a=document.querySelector(".carousel-inner");$("#gallery").on("slid.bs.carousel",function(a){a.relatedTarget.resized||(a.relatedTarget.resized=!0,jk.resizeHandler())});jk.shuffle(gallery.images);var c=function(b,c,g){b=gallery.images[b];var f=document.createElement("div");f.className="item";c&&(f.className+=" active");c=document.createElement("img");f.appendChild(c);c.src="images/gallery/"+b.name;c.originalWidth=b.width;c.originalHeight=b.height;$(c).load(g);b.caption&&
(g=document.createElement("div"),f.appendChild(g),g.className="carousel-caption",g.innerHTML=b.caption);a.appendChild(f)},b=Math.min(gallery.images.length,jk.initialGalleryLoadCount);for(jk.nextImageIndex=0;jk.nextImageIndex<b;jk.nextImageIndex++)c(jk.nextImageIndex,0===jk.nextImageIndex,null);(function e(){jk.resizeHandler();jk.nextImageIndex<gallery.images.length&&c(jk.nextImageIndex++,!1,e)})()};
jk.resizeGallery=function(a){a-=20;var c=jk.$gallery.width(),b=Math.min(Math.floor(c*gallery.maxRatio),a),d=b+"px";jk.$gallery.height(d);jk.$gallery.find("img").each(function(a,g){var f=c*g.originalHeight/g.originalWidth;f>g.originalHeight&&(f=g.originalHeight);f>b&&(f=b);$(g).css({"max-height":d,"margin-top":Math.floor(Math.max(0,(b-f)/2))+"px"})})};$(document).ready(jk.setup);
